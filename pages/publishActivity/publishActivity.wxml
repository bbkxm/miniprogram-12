<view class="container">
  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <view class="step-indicator">
    <view 
      wx:for="{{steps}}" 
      wx:key="*this" 
      class="step-item {{currentStep >= index ? 'active' : ''}}"
    >
      <view class="step-num">{{index + 1}}</view>
      <view class="step-text">{{item}}</view>
      <view wx:if="{{index < steps.length - 1}}" class="step-line"></view>
    </view>
  </view>

  <!-- æ­¥éª¤å†…å®¹ -->
  <view class="step-content">
    <!-- åŸºæœ¬ä¿¡æ¯æ­¥éª¤ -->
    <view wx:if="{{currentStep === 0}}" class="form-step">
      <view class="form-group">
        <view class="form-label">æ´»åŠ¨æ ‡é¢˜ <text class="required">*</text></view>
        <input 
          class="form-control" 
          placeholder="è¯·è¾“å…¥æ´»åŠ¨æ ‡é¢˜" 
          value="{{formData.title}}"
          bindinput="onInputTitle"
        />
      </view>
      
      <view class="form-group">
        <view class="form-label">æ´»åŠ¨å°é¢ <text class="required">*</text></view>
        <view class="form-cover">
          <block wx:if="{{formData.coverImage}}">
            <image 
              class="cover-image" 
              src="{{formData.coverImage}}" 
              mode="aspectFill"
            ></image>
            <view class="cover-change" bindtap="chooseCoverImage">æ›´æ¢å°é¢</view>
          </block>
          <view wx:else class="cover-picker" bindtap="chooseCoverImage">
            <view class="picker-icon">+</view>
            <view class="picker-text">ä¸Šä¼ å°é¢å›¾ç‰‡</view>
          </view>
        </view>
      </view>
      
      <view class="form-group">
        <view class="form-label">æ´»åŠ¨æè¿°</view>
        <textarea 
          class="form-textarea" 
          placeholder="è¯·è¾“å…¥æ´»åŠ¨æè¿°..." 
          value="{{formData.description}}"
          bindinput="onInputDescription"
        ></textarea>
      </view>
      
      <view class="form-group">
        <view class="form-label">æ´»åŠ¨æ—¶é—´</view>
        <view class="time-container">
          <view class="time-item">
            <view class="time-label">å¼€å§‹æ—¶é—´</view>
            <view class="time-picker" bindtap="showDatePicker" data-type="start">
              {{formData.startTime}}
            </view>
          </view>
          <view class="time-separator">-</view>
          <view class="time-item">
            <view class="time-label">ç»“æŸæ—¶é—´</view>
            <view class="time-picker" bindtap="showDatePicker" data-type="end">
              {{formData.endTime}}
            </view>
          </view>
        </view>
      </view>
      
      <view class="form-group">
        <view class="form-label">æ´»åŠ¨åœ°ç‚¹ <text class="required">*</text></view>
        <view class="location-picker" bindtap="chooseLocation">
          <block wx:if="{{formData.location}}">
            <view class="location-text">{{formData.location}}</view>
            <view class="location-coordinates">
              {{formData.coordinates.latitude}}, {{formData.coordinates.longitude}}
            </view>
          </block>
          <view wx:else class="location-placeholder">
            <text class="location-icon">ğŸ“</text>
            <text>ç‚¹å‡»é€‰æ‹©ä½ç½®</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- æ‰“å¡ç‚¹è®¾ç½®æ­¥éª¤ -->
    <view wx:if="{{currentStep === 1}}" class="form-step">
      <view class="checkpoint-container">
        <view class="checkpoint-title">æ‰“å¡ç‚¹åˆ—è¡¨</view>
        
        <view wx:if="{{formData.checkpoints.length === 0}}" class="checkpoint-empty">
          <text>æš‚æ— æ‰“å¡ç‚¹ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ </text>
        </view>
        
        <view wx:else class="checkpoint-list">
          <view 
            wx:for="{{formData.checkpoints}}" 
            wx:key="id" 
            class="checkpoint-item"
          >
            <view class="checkpoint-index">{{index + 1}}</view>
            <view class="checkpoint-info">
              <view class="checkpoint-name">{{item.name}}</view>
              <view class="checkpoint-coordinates">
                {{item.coordinates.latitude}}, {{item.coordinates.longitude}}
              </view>
            </view>
            <view 
              class="checkpoint-delete" 
              data-index="{{index}}"
              catchtap="deleteCheckpoint"
            >Ã—</view>
          </view>
        </view>
        
        <view class="checkpoint-add" bindtap="addCheckpoint">
          <text>+ æ·»åŠ æ‰“å¡ç‚¹</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="btn-container">
    <button 
      wx:if="{{currentStep > 0}}" 
      class="btn-prev" 
      bindtap="prevStep"
    >ä¸Šä¸€æ­¥</button>
    
    <button 
      wx:if="{{currentStep < steps.length - 1}}" 
      class="btn-next" 
      bindtap="nextStep"
    >ä¸‹ä¸€æ­¥</button>
    
    <button 
      wx:if="{{currentStep === steps.length - 1}}" 
      class="btn-submit {{submitting ? 'disabled' : ''}}"
      disabled="{{submitting}}"
      loading="{{submitting}}"
      bindtap="submitForm"
    >{{submitting ? 'æäº¤ä¸­...' : 'åˆ›å»ºæ´»åŠ¨'}}</button>
  </view>

  <!-- æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ -->
  <view wx:if="{{showDatePicker}}" class="picker-modal">
    <view class="picker-mask" catchtap="onDatePickerCancel"></view>
    <view class="picker-content">
      <view class="picker-header">
        <view class="picker-cancel" bindtap="onDatePickerCancel">å–æ¶ˆ</view>
        <view class="picker-title">é€‰æ‹©æ—¶é—´</view>
        <view class="picker-confirm" bindtap="onDatePickerConfirm">ç¡®å®š</view>
      </view>
      <picker-view 
        class="picker-view" 
        value="{{pickerValue}}" 
        bindchange="onDatePickerChange"
      >
        <!-- æ—¥æœŸé€‰æ‹©å™¨å†…å®¹ï¼Œå®é™…å¼€å‘ä¸­éœ€è¦ç»“åˆå…·ä½“éœ€æ±‚å®ç° -->
        <text class="picker-placeholder">é€‰æ‹©æ—¥æœŸæ—¶é—´ç»„ä»¶éœ€è¦å…·ä½“å®ç°</text>
      </picker-view>
    </view>
  </view>
</view> 